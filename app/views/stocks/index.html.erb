<h1>My Portfolio</h1>
<div id="stocks">
  <div class="row d-flex justify-content-center">

    <% @stocks.each do |stock| %>

    <% quote_hash = JSON.parse((@finnhub_client.quote(stock.ticker)).to_json) %>
    <% profile_hash = JSON.parse((@finnhub_client.company_profile2({symbol: stock.ticker})).to_json) %>
    <% metric_hash = JSON.parse((@finnhub_client.company_basic_financials('AAPL', 'all')).to_json) %>

    <div class="col-md-6 col-lg-4 col-xl-3 d-flex justify-content-center">
      <div class="card stock-card">
        <%= render 'stock', :quote => quote_hash, :profile => profile_hash, :metric => metric_hash %>
        <div>
          <%= link_to "Show Details", stock, class: "btn btn-primary" %>
          <%= link_to "Delete", stock, data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this stock from your portfolio?" }, class: "btn btn-danger mx-1" %>
        </div>  
      </div>
    </div>

    <% end %>
    
  </div>
</div>

<%= link_to "New stock", new_stock_path %>
